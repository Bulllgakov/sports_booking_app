# Исправление проблемы со смещением дат при разных часовых поясах

## Проблема
При изменении часового пояса на компьютере пользователя даты бронирований отображались неправильно:
- Екатеринбург (+5): даты показываются корректно
- Москва (+3): все бронирования смещаются на 1 день назад

## Причина
Функция `stringToDate` в `utils/dateTime.ts` использовала локальное время компьютера:
```typescript
return new Date(dateString + 'T00:00:00')
```

Это приводило к тому, что одна и та же дата интерпретировалась по-разному в зависимости от часового пояса компьютера.

## Решение
1. **Создан новый модуль** `utils/clubDateTime.ts` с функциями для работы с датами в контексте часового пояса клуба
2. **Используется часовой пояс клуба** из настроек (поле `timezone` в venues)
3. **Обновлены компоненты**:
   - `BookingsManagement.tsx` - использует `normalizeDateInClubTZ` и `getWeekStartInClubTZ/getWeekEndInClubTZ`
   - `BookingDetailsModal.tsx` - использует `normalizeDateInClubTZ` для дат бронирований

## Ключевые функции

### `normalizeDateInClubTZ(dateValue, clubTimezone)`
Безопасно преобразует различные форматы даты (Timestamp, string, Date) с учетом часового пояса клуба.

### `stringToDateInClubTZ(dateString, clubTimezone)`
Преобразует строку даты в Date объект, интерпретируя её как полночь в часовом поясе клуба.

### `getWeekStartInClubTZ(date, clubTimezone)`
Возвращает начало недели (понедельник) в часовом поясе клуба.

## Преимущества решения
1. **Безопасность** - существующие данные не изменяются
2. **Консистентность** - даты всегда отображаются в часовом поясе клуба
3. **Независимость** - корректное отображение независимо от часового пояса компьютера пользователя
4. **Обратная совместимость** - при отсутствии timezone используется UTC для консистентности

## Тестирование
Для проверки исправления:
1. Установите часовой пояс клуба в настройках (например, Asia/Yekaterinburg)
2. Создайте несколько бронирований
3. Измените часовой пояс компьютера
4. Убедитесь, что даты бронирований отображаются корректно

## Важно
- Часовой пояс клуба должен быть установлен в настройках (Управление клубом → Часовой пояс)
- По умолчанию используется Europe/Moscow
- При изменении часового пояса клуба может потребоваться перезагрузка страницы